<html>
<meta charset="utf-8">
<title>學習系統-Array教學</title>
<script>

    var second = 0;
    var stayTime,beforeTime;
    function timeCount() {
        beforeTime =  localStorage.getItem("stayTime");
        stayTime = setInterval(function () {
            second++;
            localStorage.setItem("stayTime",beforeTime+"@學習系統-Array教學 停留時間："+second+"\n");
        }, 1000);
    }

</script>

<body onload='timeCount();'>
    原始陣列：
    <button type="button" id="random" onclick="Random()">亂數產生</button> <br><br>
    <table style="border:solid thin;">
        <tr>
            <td>A[0]</td>
            <td>A[1]</td>
            <td>A[2]</td>
            <td>A[3]</td>
            <td>A[4]</td>
            <td>A[5]</td>
            <td>A[6]</td>
            <td>A[7]</td>
            <td>A[8]</td>
            <td>A[9]</td>
        </tr>
        <tr>
            <td><input style="width:45px" type="number" id="input0"></td>
            <td><input style="width:45px" type="number" id="input1"></td>
            <td><input style="width:45px" type="number" id="input2"></td>
            <td><input style="width:45px" type="number" id="input3"></td>
            <td><input style="width:45px" type="number" id="input4"></td>
            <td><input style="width:45px" type="number" id="input5"></td>
            <td><input style="width:45px" type="number" id="input6"></td>
            <td><input style="width:45px" type="number" id="input7"></td>
            <td><input style="width:45px" type="number" id="input8"></td>
            <td><input style="width:45px" type="number" id="input9"></td>
        </tr>
    </table>
    模式：
    <input type="radio" id="mode1" name="mode" onclick="mode = 1;"> Animation
    <input type="radio" id="mode2" name="mode" onclick="mode = 2;"> Step
    <input type="radio" id="mode3" name="mode" onclick="mode = 3;"> Run All
    <br>
    速度：
    <input type="radio" id="speed1" name="speed" onclick="speed = 1;"> 快
    <input type="radio" id="speed2" name="speed" onclick="speed = 2;"> 中
    <input type="radio" id="speed3" name="speed" onclick="speed = 3;"> 慢
    <br>
    <button id="start" onclick="start()"> 開始處理 </button>
    <button id="next" onclick="next()" disabled='true'> 下一步 </button>
    <button id="clear" onclick="restart()"> 清除所有欄位 </button>
    <br>
    <div id="Pos">
        <canvas id="canvasCode" width="550" height="250">
            This text is displayed if your browser does not support HTML5 Canvas.
        </canvas>
    </div>
    <canvas id="canvasChart" width="1000" height="300">
        This text is displayed if your browser does not support HTML5 Canvas.
    </canvas>
    <br>
    目前步驟：
    <br>
    <textarea cols="100" rows="4" readonly="readonly" id="process1"></textarea><br>
    所有過程：
    <br>
    <textarea cols="100" rows="16" readonly="readonly" id="process2"></textarea><br>
</body>
<script>

    var interval;
    var mode = speed = 0;
    var delay = 1000;
    var allStep = [];
    var A = [];
    var B = [];
    var Aold = [];
    var storeArr = [];
    var arrCount = 0;
    var stepCount = 0;
    var countNext = countAnime = 0;
    var canvas1 = document.getElementById('canvasChart');
    var canvasChart = canvas1.getContext('2d');
    var canvas2 = document.getElementById('canvasCode');
    var canvasCode = canvas2.getContext('2d');

    var A0 = document.getElementById("input0");
    var A1 = document.getElementById("input1");
    var A2 = document.getElementById("input2");
    var A3 = document.getElementById("input3");
    var A4 = document.getElementById("input4");
    var A5 = document.getElementById("input5");
    var A6 = document.getElementById("input6");
    var A7 = document.getElementById("input7");
    var A8 = document.getElementById("input8");
    var A9 = document.getElementById("input9");
    function start() {
        canvasCode.clearRect(0, 0, 550, 250);
        canvasChart.clearRect(0, 0, 1000, 300);
        clearInterval(interval);
        countAnime = 0;
        arrCount = 0;
        process1.value = "";
        process2.value = "";
        document.getElementById('random').disabled = true;
        if (A0.value == "" || A1.value == "" || A2.value == "" || A3.value == "" || A4.value == "" || A5.value == "" || A6.value == "" || A7.value == "" || A8.value == "" || A9.value == "") {
            alert("請輸入陣列內容");
            document.getElementById('random').disabled = false;
            return;
        }
        if (mode == 1) {
            if (speed == 1)
                delay = 1000;
            else if (speed == 2)
                delay = 2000;
            else if (speed == 3)
                delay = 3000;
            else {
                alert("請選擇速度");
                document.getElementById('random').disabled = false;
                return;
            }
        }
        else if (mode == 2) {
            document.getElementById('next').disabled = false;
            document.getElementById('start').disabled = true;
        }
        else if (mode == 3) {
            document.getElementById('next').disabled = true;
            document.getElementById('start').disabled = true;
        }
        else {
            alert("請選擇顯示模式");
            document.getElementById('random').disabled = false;
            return;
        }

        document.getElementById('mode1').disabled = true;
        document.getElementById('mode2').disabled = true;
        document.getElementById('mode3').disabled = true;
        drawCode();
        drawChart();
        if (stepCount == 0) {
            cal();
        }
        if (mode == 1) {
            interval = setInterval(anime, delay);
            document.getElementById('start').disabled = false;
            document.getElementById('speed1').disabled = false;
            document.getElementById('speed2').disabled = false;
            document.getElementById('speed3').disabled = false;
        }
        else {
            document.getElementById('start').disabled = true;
            document.getElementById('speed1').disabled = true;
            document.getElementById('speed2').disabled = true;
            document.getElementById('speed3').disabled = true;
        }
        if (mode == 3) {
            RunAll();
        }
    }
    function next() {
        if (countNext < allStep.length) {
            process1.value = allStep[countNext];
            process2.value += allStep[countNext];
            process2.scrollTop = process2.scrollHeight;
            fillCode(countNext);
            fillChart(countNext);
            drawCode();
            drawChart();
        }
        else {
            document.getElementById('next').disabled = true;
        }
        countNext++;
    }
    function anime() {
        if (countAnime < allStep.length) {
            process1.value = allStep[countAnime];
            process2.value += allStep[countAnime];
            process2.scrollTop = process2.scrollHeight;
            fillCode(countAnime);
            fillChart(countAnime);
            drawCode();
            drawChart();
        }
        countAnime++;
        // result
        if (countAnime == allStep.length)
            clearInterval(interval);
    }
    function RunAll() {
        for (var i = 0; i < allStep.length; i++) {
            process1.value = allStep[i];
            process2.value += allStep[i];
            process2.scrollTop = process2.scrollHeight;
            fillCode(i);
            fillChart(i);
        }
        drawCode();
        drawChart();
    }
    function restart() {
        clearInterval(interval);
        document.getElementById('start').disabled = false;
        document.getElementById('next').disabled = true;
        document.getElementById('random').disabled = false;
        document.getElementById('start').checked = false;
        document.getElementById('mode1').checked = false;
        document.getElementById('mode2').checked = false;
        document.getElementById('mode3').checked = false;
        document.getElementById('speed1').checked = false;
        document.getElementById('speed2').checked = false;
        document.getElementById('speed3').checked = false;
        document.getElementById('mode1').disabled = false;
        document.getElementById('mode2').disabled = false;
        document.getElementById('mode3').disabled = false;
        document.getElementById('speed1').disabled = false;
        document.getElementById('speed2').disabled = false;
        document.getElementById('speed3').disabled = false;

        A0.value = "";
        A1.value = "";
        A2.value = "";
        A3.value = "";
        A4.value = "";
        A5.value = "";
        A6.value = "";
        A7.value = "";
        A8.value = "";
        A9.value = "";
        clear();
    }
    function clear() {
        mode = speed = 0;
        delay = 1000;
        allStep = [];
        A = [];
        B = [];
        storeArr = [];
        Aold = [];
        arrCount = 0;
        stepCount = 0;
        countNext = 0;
        countAnime = 0;

        process1.value = "";
        process2.value = "";

        canvasCode.clearRect(0, 0, 550, 250);
        canvasChart.clearRect(0, 0, 1000, 300);
    }
    function readTable() {
        A[0] = parseInt(A0.value);
        A[1] = parseInt(A1.value);
        A[2] = parseInt(A2.value);
        A[3] = parseInt(A3.value);
        A[4] = parseInt(A4.value);
        A[5] = parseInt(A5.value);
        A[6] = parseInt(A6.value);
        A[7] = parseInt(A7.value);
        A[8] = parseInt(A8.value);
        A[9] = parseInt(A9.value);
        for (var index = 0; index < A.length; index++) {
            Aold[index] = A[index];

        }
    }
    function Random() {
        A0.value = Math.floor(Math.random() * 100);
        A1.value = Math.floor(Math.random() * 100);
        A2.value = Math.floor(Math.random() * 100);
        A3.value = Math.floor(Math.random() * 100);
        A4.value = Math.floor(Math.random() * 100);
        A5.value = Math.floor(Math.random() * 100);
        A6.value = Math.floor(Math.random() * 100);
        A7.value = Math.floor(Math.random() * 100);
        A8.value = Math.floor(Math.random() * 100);
        A9.value = Math.floor(Math.random() * 100);
    }
    function cal() {
        readTable();
        for (var i = 0; i < 10; i++) {
            B[i] = 10;
            allStep[stepCount] = "B[" + i + "]=" + B[i] + "  (將10填入B[" + i + "])\n";
            storeArr[stepCount] = 0;
            stepCount++;
        }
        allStep[stepCount] = "創建一個空陣列=>\n";
        storeArr[stepCount] = 1;
        stepCount++;
        allStep[stepCount] = "創建完成，開始相加=>\n";
        storeArr[stepCount] = 2;
        stepCount++;
        var j = 0;
        while (j < A.length) {
            A[j] += B[j];
            allStep[stepCount] = "A[" + j + "]=" + A[j] + "  (將B[" + j + "]的值加進A[" + j + "])\n";
            storeArr[stepCount] = 3;
            stepCount++;
            j++;
        }
        allStep[stepCount] = "程式結束。";
        storeArr[stepCount] = 4;
    }

    function drawCode() {
        canvasCode.fillStyle = "black";
        canvasCode.font = "18px Verdana";
        canvasCode.fillText("for(int i=0;i<10;i++)", 20, 20);
        canvasCode.fillText('{', 20, 40);
        canvasCode.fillText('B[i]=10;', 50, 60);
        canvasCode.fillText('}', 20, 80);
        canvasCode.fillText("int[] A = new int[10];", 20, 100);
        canvasCode.fillText("int j=0;", 20, 120);
        canvasCode.fillText('while(j<A.length)', 20, 140);
        canvasCode.fillText('{', 20, 160);
        canvasCode.fillText('A[j] += B[j];', 50, 180);
        canvasCode.fillText('j++;', 50, 200);
        canvasCode.fillText('}', 20, 220);
    }
    function drawChart() {
        canvasChart.globalCompositeOperation = "destination-over";
        canvasChart.fillStyle = "#F7E9E7";
        canvasChart.fillRect(75, 75, 850, 40);
        canvasChart.strokeStyle = "#D34817";
        canvasChart.fillStyle = "#D34817";
        canvasChart.strokeRect(75, 75, 850, 40);
        canvasChart.globalCompositeOperation = "source-over";
        canvasChart.beginPath();
        canvasChart.moveTo(160, 75);
        canvasChart.lineTo(160, 115);
        canvasChart.stroke();

        canvasChart.beginPath();
        canvasChart.moveTo(245, 75);
        canvasChart.lineTo(245, 115);
        canvasChart.stroke();

        canvasChart.beginPath();
        canvasChart.moveTo(330, 75);
        canvasChart.lineTo(330, 115);
        canvasChart.stroke();

        canvasChart.beginPath();
        canvasChart.moveTo(415, 75);
        canvasChart.lineTo(415, 115);
        canvasChart.stroke();

        canvasChart.beginPath();
        canvasChart.moveTo(500, 75);
        canvasChart.lineTo(500, 115);
        canvasChart.stroke();

        canvasChart.beginPath();
        canvasChart.moveTo(585, 75);
        canvasChart.lineTo(585, 115);
        canvasChart.stroke();

        canvasChart.beginPath();
        canvasChart.moveTo(670, 75);
        canvasChart.lineTo(670, 115);
        canvasChart.stroke();

        canvasChart.beginPath();
        canvasChart.moveTo(755, 75);
        canvasChart.lineTo(755, 115);
        canvasChart.stroke();

        canvasChart.beginPath();
        canvasChart.moveTo(840, 75);
        canvasChart.lineTo(840, 115);
        canvasChart.stroke(); //第一個表格

        canvasChart.fillStyle = "black";
        canvasChart.font = '25px "微軟正黑體"';
        canvasChart.fillText('B[0]', 80, 60);
        canvasChart.fillText('B[1]', 165, 60);
        canvasChart.fillText('B[2]', 250, 60);
        canvasChart.fillText('B[3]', 335, 60);
        canvasChart.fillText('B[4]', 420, 60);
        canvasChart.fillText('B[5]', 505, 60);
        canvasChart.fillText('B[6]', 590, 60);
        canvasChart.fillText('B[7]', 675, 60);
        canvasChart.fillText('B[8]', 760, 60);
        canvasChart.fillText('B[9]', 845, 60);
    }
    function fillCode(i) {
        canvasCode.fillStyle = "#FFFFFF";
        canvasCode.clearRect(0, 0, 550, 250);
        canvasCode.fillStyle = "khaki";

        if (storeArr[i] == 0) {
            canvasCode.fillRect(0, 45, 550, 20);
        }
        else if (storeArr[i] == 1) {
            canvasCode.fillRect(0, 85, 550, 20);
        }
        else if (storeArr[i] == 2) {
            canvasCode.fillRect(0, 105, 550, 20);
            arrCount = 0;
        }
        else if (storeArr[i] == 3) {
            canvasCode.fillRect(0, 165, 550, 20);
        }
    }
    function fillChart(i) {
        canvasChart.fillStyle = "#FFFFFF";
        canvasChart.clearRect(0, 0, 1000, 300);
        canvasChart.fillStyle = "black";
        if (storeArr[i] == 0) {
            for (var index = 0; index <= arrCount; index++) {
                canvasChart.fillText(B[index], 85 + index * 85, 105);
            }
            arrCount++;
        }
        else if (storeArr[i] > 0) {
            drawChart2();
            for (var index = 0; index <= 9; index++) {
                canvasChart.fillText(B[index], 85 + index * 85, 105);
            }
            if (storeArr[i] > 2) {
                for (var index = 0; index < 10; index++) {
                    if (arrCount == index) {
                        canvasChart.fillStyle = "red";
                    }
                    else {
                        canvasChart.fillStyle = "black";
                    }
                    if (index > arrCount) {
                        canvasChart.fillText(Aold[index], 85 + index * 85, 225);
                    }
                    else {
                        canvasChart.fillText(A[index], 85 + index * 85, 225);
                    }
                }
                arrCount++;
            }
        }
    }
    function drawChart2() {
        canvasChart.fillStyle = "#F7E9E7";
        canvasChart.fillRect(75, 195, 850, 40);
        canvasChart.strokeStyle = "#D34817";
        canvasChart.fillStyle = "#D34817";
        canvasChart.strokeRect(75, 195, 850, 40);

        canvasChart.beginPath();
        canvasChart.moveTo(160, 195);
        canvasChart.lineTo(160, 235);
        canvasChart.stroke();

        canvasChart.beginPath();
        canvasChart.moveTo(245, 195);
        canvasChart.lineTo(245, 235);
        canvasChart.stroke();

        canvasChart.beginPath();
        canvasChart.moveTo(330, 195);
        canvasChart.lineTo(330, 235);
        canvasChart.stroke();

        canvasChart.beginPath();
        canvasChart.moveTo(415, 195);
        canvasChart.lineTo(415, 235);
        canvasChart.stroke();

        canvasChart.beginPath();
        canvasChart.moveTo(500, 195);
        canvasChart.lineTo(500, 235);
        canvasChart.stroke();

        canvasChart.beginPath();
        canvasChart.moveTo(585, 195);
        canvasChart.lineTo(585, 235);
        canvasChart.stroke();

        canvasChart.beginPath();
        canvasChart.moveTo(670, 195);
        canvasChart.lineTo(670, 235);
        canvasChart.stroke();

        canvasChart.beginPath();
        canvasChart.moveTo(755, 195);
        canvasChart.lineTo(755, 235);
        canvasChart.stroke();

        canvasChart.beginPath();
        canvasChart.moveTo(840, 195);
        canvasChart.lineTo(840, 235);
        canvasChart.stroke();//第二個表格

        canvasChart.fillStyle = "black";
        canvasChart.font = '25px "微軟正黑體"';
        canvasChart.fillText('A[0]', 80, 180);
        canvasChart.fillText('A[1]', 165, 180);
        canvasChart.fillText('A[2]', 250, 180);
        canvasChart.fillText('A[3]', 335, 180);
        canvasChart.fillText('A[4]', 420, 180);
        canvasChart.fillText('A[5]', 505, 180);
        canvasChart.fillText('A[6]', 590, 180);
        canvasChart.fillText('A[7]', 675, 180);
        canvasChart.fillText('A[8]', 760, 180);
        canvasChart.fillText('A[9]', 845, 180);
    }
</script>

</html>